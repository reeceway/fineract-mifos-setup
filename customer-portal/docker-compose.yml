version: '3.8'

# =============================================================================
# CUSTOMER SELF-SERVICE PORTAL
# =============================================================================
# Official Mifos Community App configured for customer self-service
# =============================================================================

services:
  customer-portal:
    image: openmf/community-app:latest
    container_name: mifos-customer-portal
    restart: always
    ports:
      - "4200:80"
    environment:
      # SECURITY: Point to the HTTPS Fineract API
      - FINERACT_API_URL=https://fineract-server:8443
      - FINERACT_API_PROVIDER=/fineract-provider/api
      - FINERACT_API_VERSION=/v1
      - FINERACT_PLATFORM_TENANT_IDENTIFIER=default
      # Self-service mode
      - MIFOS_DEFAULT_LANGUAGE=en-US
      - MIFOS_PRELOAD_CLIENTS=false
    networks:
      - customer-network
      - mifos-fineract-network
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 256M

networks:
  customer-network:
    name: customer-network
    driver: bridge
  mifos-fineract-network:
    external: true